{% extends 'base.html' %}
{% load thumbnail %}
{% load waffle_tags %}
{% load markup %}
{% load urlize_target_blank %}



{% block content %}
{% flag "main" %}

{% else %}
<div class="loader">
  <svg version="1.1"
    class="svg-loader"
    xmlns="http://www.w3.org/2000/svg"
    xmlns:xlink="http://www.w3.org/1999/xlink"
    x="0px"
    y="0px"
    viewBox="0 0 80 80"
    xml:space="preserve">

    <path
      id="spinner"
      fill="#000"
      d="M40,72C22.4,72,8,57.6,8,40C8,22.4,
      22.4,8,40,8c17.6,0,32,14.4,32,32c0,1.1-0.9,2-2,2
      s-2-0.9-2-2c0-15.4-12.6-28-28-28S12,24.6,12,40s12.6,
      28,28,28c1.1,0,2,0.9,2,2S41.1,72,40,72z"
    >

      <animateTransform
        attributeType="xml"
        attributeName="transform"
        type="rotate"
        from="0 40 40"
        to="360 40 40"
        dur="0.6s"
        repeatCount="indefinite"
      />
    </path>
  </svg>
</div>

<div id="site-wrapper">
	<header>
		<div id="header-wrapper">
			<a href="#"><h2>SPOKEHUB</h2></a>
			<a href="#"><h3>member login</h3></a>
		</div>
	</header>
	<div class="content-wrapper">
		<div class="columns">
			<div class="column full-column" id="how-column"><h1>how</h1></div>
			<div class="column full-column" id="we-column"><h1>we</h1></div>
			<div class="column full-column" id="work-column"><h1>work</h1></div>
			<div class="column full-column" id="now-column"><h1>now</h1></div>
		</div>
		<div class="sections">
			<section class="main-section hide" data-target="how-column">
				{% include "main/how.html" %}
			</section>
			<section class="main-section hide" data-target="we-column">
				{% include "main/we.html" %}
			</section>
			<section class="main-section hide" data-target="work-column">
				{% include "main/work.html" %}
			</section>
			<section class="main-section hide" data-target="now-column">
				{% include "main/now.html" %}
			</section>
		</div>
	</div>
</div>
<div class="about-container" id="about-button">
    <div class="about-title">
       <h3>SPOKEHUB is an art + design think tank, based in Berlin, with global creative partners.</h3>
    </div>
    <div class="about-copy">
      <p>We offer insights, strategy, design and curation, with 5 principles in mind:</p>
      <p>#1 SPOKEHUB unfucks today's issues, to make the <b>future</b> better for everyone.</p>
      <p>#2 SPOKEHUB creates design with <b>he(art);</b> passion and meaning are our priorities.</p>
      <p>#3 SPOKEHUB combines strategy, art and design thinking, on every <b>team</b> and mission.</p>
      <p>#4 SPOKEHUB breaks bad habits, patterns and <b>norms</b>, with constructive disruption.</p>
      <p>#5 SPOKEHUB works with knowledge (not guess-ledge), so our work is grounded in <b>truth</b> and effects real change.</p>
    </div>
    <div class="about-undertitle">
      <p>Our website is undergoing its annual polish, so give <a href="https://www.linkedin.com/in/onikasimon">Onika</a> a call if you'd like to know more.</p>
    </div>
</div>

{% endflag %}
{% endblock %}

{% block js %}
{% flag "main" %}

<link href="/media/bootstrap-lightbox.css" rel="stylesheet"></script>
<script src="/media/bootstrap-lightbox.js"></script>
<script src="/media/js/masonry.pkgd.js"></script>
<script src="/media/js/jquery.infinitescroll.min.js"></script>
<script src="/media/js/jquery.flexslider-min.js"></script>

<script>
	var $container = $('#nowtiles');
	// initialize
	$('#nowtiles').masonry({
    columnWidth: 40,
    itemSelector: '.nowtile'
  });

  $container.infinitescroll({
      navSelector  : '#now-nav',
      nextSelector : '#now-nav a',
      itemSelector : '.nowtile',

      errorCallback: function () { console.log('had an error'); },

      loading: {
          finishedMsg: 'No more pages to load.'
//          img: 'http://i.imgur.com/6RMhx.gif'
        }
      },

      // trigger Masonry as a callback
      function( newElements ) {
        // hide new items while they are loading
        var $newElems = $( newElements ).css({ opacity: 0 });
        // ensure that images load before adding to masonry layout
// imagesLoaded seems to be broken...
// going without for now..
//        $newElems.imagesLoaded(function(){
          // show elems now they're ready
          $newElems.animate({ opacity: 1 });
          $container.masonry( 'appended', $newElems, true );
//        });

// don't know why, but it seems that I need to manually
// detect the end of the scrolling and stop it
// or it does weird stuff...
        if ($newElems.length < 50) {
           $container.infinitescroll('destroy');
           return;
        }

      }
    );

</script>
<script type="text/javascript" charset="utf-8">

  function showSection(identifier) {
	   $('.collapse').collapse({'toggle':false, 'parent': '#accordian'})
                   .collapse('hide');
     $(identifier).collapse({'toggle':true, 'parent': '#accordian'}).collapse('show');
  }

  $(window).ready(function() {
    $('#flexslider').flexslider({
    	smoothHeight: false,
// this one breaks it. don't know why.
//    	itemWidth: 1200,
    	maxItems: 0,
      animationLoop: true,
    	controlNav: false
    });

  if (window.location.hash === '#how')  { showSection('#how'); }
  if (window.location.hash === '#we')   { showSection('#we'); }
  if (window.location.hash === '#work') { showSection('#work'); }
  if (window.location.hash === '#now')  { showSection('#now'); }

  });
</script>

<script>
$(".panel").on('hidden.bs.collapse', function (e) {
   $(e.target).parent().removeClass('active-panel');
});
$(".panel").on('shown.bs.collapse', function (e) {
   $(e.target).parent().addClass('active-panel');
});
</script>

{% else %}
<script src="/media/js/jquery.min.js"></script>
<script src="/media/js/main.js"></script>
<script type="text/javascript">
  $(window).load(function(){
     // PAGE IS FULLY LOADED
     // FADE OUT YOUR OVERLAYING DIV
     $('.loader').delay(800).fadeOut();
     $('#site-wrapper').delay(1600).fadeIn();
  });
</script>
{% endflag %}
{% endblock %}
