{% extends 'base.html' %}
{% load thumbnail %}
{% load waffle_tags %}
{% load markup %}

{% block navbar %}
	<ul class="nav nav-justified">
      <li><button type="button" class="btn hubnav"
{% flag section_how %}
									data-toggle="collapse"
									data-target="#collapseOne"
{% endflag %}
									data-parent="#accordian">HOW</button></li>
      <li><button type="button" class="btn hubnav"
{% flag section_we %}
									data-toggle="collapse"
									data-target="#collapseTwo"
{% endflag %}
									data-parent="#accordian">WE</button></li>
      <li><button type="button" class="btn hubnav"
{% flag section_work %}
									data-toggle="collapse"
									data-target="#collapseThree"
{% endflag %}
									data-parent="#accordian">WORK</button></li>
      <li><button type="button" class="btn hubnav"
{% flag section_now %}
									data-toggle="collapse"
									data-target="#collapseFour"
{% endflag %}
									data-parent="#accordian">NOW</button></li>

		</ul>
{% endblock %}

{% block bodytag %}
{% if request.user.is_anonymous %}
<body class="" id="splash-page">
{% else %}
<body class="{% block bodyclass %}{% endblock %}" id="index-page{% block bodyid %}{% endblock %}">
{% endif %}
{% endblock %}

{% block content %}


<div class="panel-group" id="accordion">
  <div class="panel panel-default">
    <a {% flag section_how %} data-toggle="collapse"
			 data-parent="#accordion" href="#collapseOne"{% endflag %}>
    	<div id="hub1" class="panel-heading">
      	<div class="panel-title"> 
         How
        </div>
        <div class="desc">Cross-functional conversations between Art, Design, and Strategy</div>
        <span class="glyphicon glyphicon-play"></span>
        
	    </div>
     </a>
{% flag section_how %}
    <div id="collapseOne" class="panel-collapse collapse">
      <div class="panel-body">
				<div class="container">
       <div class="panelbreak white"></div>
			 {% if conversation %}

			 <form action="/item/{{conversation.id}}/reply/" method="post"
						 enctype="multipart/form-data" role="form">
				 <div class="modal fade" id="add-text-reply">
					 <div class="modal-dialog">
						 <div class="modal-content">
							 <div class="modal-header">
								 <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
								 <h4 class="modal-title">Add Reply</h4>
							 </div>
							 <div class="modal-body">

								 <div class="form-group">
									 <label for="comment-body">Comment</label>
									 <textarea name="body" class="form-control" rows="10"
														 id="comment-body"></textarea>
								 </div>

							 </div>
							 <div class="modal-footer">
								 <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
								 <input type="submit" class="btn btn-primary" value="Reply"/>
							 </div>
						 </div><!-- /.modal-content -->
					 </div><!-- /.modal-dialog -->
				 </div><!-- /.modal -->
			 </form>

			 <form action="/item/{{conversation.id}}/reply/" method="post"
						 enctype="multipart/form-data" role="form">
				 <div class="modal fade" id="add-image-reply">
					 <div class="modal-dialog">
						 <div class="modal-content">
							 <div class="modal-header">
								 <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
								 <h4 class="modal-title">Add Image Reply</h4>
							 </div>
							 <div class="modal-body">

								 <div class="form-group">
									 <label for="exampleInputFile">Image</label>
									 <input type="file" id="image" name="image">
								 </div>

								 <div class="form-group">
									 <label for="comment-body">Caption</label>
									 <textarea name="body" class="form-control" rows="10"
														 id="comment-body"></textarea>
								 </div>

							 </div>
							 <div class="modal-footer">
								 <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
								 <input type="submit" class="btn btn-primary" value="Reply"/>
							 </div>
						 </div><!-- /.modal-content -->
					 </div><!-- /.modal-dialog -->
				 </div><!-- /.modal -->
			 </form>


       <h2>{{conversation.title}}</h2>
			 {{conversation.body|markdown}}
			 <div class="panelbreak white"></div>
			 <p>Add your voice to the conversation:
				 <ul class="list-inline">
					 <li><a href="#add-text-reply" data-toggle="modal"
									data-target="#add-text-reply" class="btn btn-primary">Text</a></li>
					 <li><span class="btn btn-primary" disabled>Link</span></li>
					 <li><a href="#add-image-reply" data-toggle="modal"
									data-target="#add-image-reply" class="btn btn-primary">Image</a></li>
				 </ul>
			 </p>
			 <div class="panelbreak white"></div>
			 <div class="hubconvo">

{% for reply_one, reply_two in conversation.reply_pairs %}

				 <div class="row">
					 <div class="col-sm-1 col-md-1">
						 <a href="/accounts/{{reply_one.author.username}}/"><img class="mugshot" src="{{ reply_one.author.get_profile.get_mugshot_url }}" 
									class="user_icon" width="100" height="100"></a>
						 </div>
					<div class="col-sm-5 col-md-5">
						<div class="convoblock">
								<div class="user_name"><a href="/accounts/{{reply_one.author.username}}/">{{reply_one.author.username}}</a>
								| {{reply_one.author.get_profile.discipline1}}{% if reply_one.author.get_profile.discipline2 %} /
								{{reply_one.author.get_profile.discipline2}}{% endif %}</div>
								<div class="user_time">{{reply_one.added|timesince}}
								ago  |  {{reply_one.author.get_profile.city}}, {{reply_one.author.get_profile.country}}</div>
								       <div class="panelbreak black"></div>
								{{reply_one.body|markdown}}
											 {% if reply_one.image %}
											 <img src="{% thumbnail reply_one.image 400x400 %}" />
								{% endif %}
						</div>
					</div>
{% if reply_two %}
					<div class="col-sm-5 col-md-5">
						<div class="convoblock">
								<div class="user_name"><a href="/accounts/{{reply_two.author.username}}/">{{reply_two.author.username}}</a>
									| {{reply_two.author.get_profile.discipline1}}
{% if reply_two.author.get_profile.discipline1 %}
/ {{reply_two.author.get_profile.discipline2}}{% endif %}</div>
								<div class="user_time">{{reply_two.added|timesince}}
								ago  |  {{reply_two.author.get_profile.city}}, {{reply_two.author.get_profile.country}}</div>
								       <div class="panelbreak black"></div>
											 {{reply_two.body|markdown}}
											 {% if reply_two.image %}
											 <img src="{% thumbnail reply_two.image 400x400 %}" />
								{% endif %}
								
						</div>
					</div>
					<div class="col-sm-1 col-md-1">
						 <a href="/accounts/{{reply_two.author.username}}/"><img class="mugshot" src="{{ reply_two.author.get_profile.get_mugshot_url }}" 
									class="user_icon" width="100" height="100"></a>
					</div>
{% endif %}
				 </div>
				 {% endfor %}

				</div>
			 {% else %}

			 <p>No conversations yet...</p>
			 {% endif %}

				</div>
      </div>
    </div>
{% endflag %}
  </div>
  <div class="panel panel-default">
  <a {% flag section_we %}data-toggle="collapse"
		 data-parent="#accordion" href="#collapseTwo"{% endflag %}>
  	 <div id="hub2" class="panel-heading">
      <div class="panel-title">
          We        
      </div>
      <div class="desc">A MANIFESTO OF (TROUBLE) MAKERS</div>
      <span class="glyphicon glyphicon-play"></span>
    </div>
      </a>
{% flag section_we %}
    <div id="collapseTwo" class="panel-collapse collapse">
      <div class="panel-body">
				<div class="container">
<iframe src="//player.vimeo.com/video/104999392" width="900"
				height="506" frameborder="0" webkitallowfullscreen
				mozallowfullscreen allowfullscreen></iframe>
				</div>
      </div>
    </div>
{% endflag %}
  </div>

  <div class="panel panel-default">
<a {% flag section_work %} data-toggle="collapse"
	 data-parent="#accordion" href="#collapseThree"{% endflag %}>  	
    <div id="hub3" class="panel-heading">
      <div class="panel-title">
          Work        
      </div>
      <div class="desc">Shiny ideas + blood, sweat and tears</div>
      <span class="glyphicon glyphicon-play"></span>
    </div>
</a>
{% flag section_work %}
    <div id="collapseThree" class="panel-collapse collapse">
      <div class="panel-body">

				<div class="work-samples">
					<ul class="slides">
						{% for ws in work_samples %}
						<li>
							<img src="{% thumbnail ws.image 900x600 %}" alt="{{ws.title}}"/>
							<p class="flex-caption">{{ws.user.username}}: {{ws.title}}</p>
						</li>
						{% endfor %}
					</ul>
				</div>
      </div>
    </div>
{% endflag %}
  </div>

  <div class="panel panel-default active-panel">
<a {% flag section_now %}data-toggle="collapse"
	 data-parent="#accordion" href="#collapseFour"{% endflag %}>
  	    <div id="hub4" class="panel-heading">
      <div class="panel-title">
          Now
      </div>
      <div class="desc">Updates in Hub Mean Time (HMT)</div>
      <span class="glyphicon glyphicon-play"></span>
    </div>
      </a>
{% flag section_now %}
    <div id="collapseFour" class="panel-collapse collapse in">
      <div class="panel-body">
				<div id="worktiles">

					{% for post in now_posts %}
					<div class="tile">
						<a href="/accounts/{{post.user.username}}/">{{post.user.username}}</a><br />
						{% if post.image_url %}
						<img src="{{post.image_url}}"
								 width="{{post.image_width}}"
								 height="{{post.image_height}}" /><br />
						{% endif %}
						{{post.text}}<br />
						<a href="{{post.external_link}}">{{post.created|timesince}} ago</a>
					</div>
					{% endfor %}
				
     			 </div>
    </div>
  </div>
{% endflag %}
</div>

{% endblock %}

{% block js %}
<script src="/media/js/flexslide/jquery.flexslider-min.js"></script>
<script src="/media/js/masonry.pkgd.js"></script>

<link rel="stylesheet" href="/media/js/flexslide/flexslider.css" type="text/css">
<script>
	var $container = $('#worktiles');
	// initialize
	$('#worktiles').masonry({
  columnWidth: 20,
  itemSelector: '.tile'
});

</script>
<script>
$(window).load(function() {
  $('.work-samples').flexslider({
    animation: "slide"
  });
});
</script>
<script>
$(".panel").on('hidden.bs.collapse', function (e) {
   $(e.target).parent().removeClass('active-panel');
})
$(".panel").on('shown.bs.collapse', function (e) {
   $(e.target).parent().addClass('active-panel');
})
</script>


{% endblock %}
