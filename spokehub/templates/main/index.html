{% extends 'base.html' %}
{% load thumbnail %}
{% load waffle_tags %}
{% load markup %}

{% block navbar %}
	<ul class="nav nav-justified">
      <li><button type="button" class="btn hubnav"
{% flag section_how %}
									data-toggle="collapse"
									data-target="#collapseOne"
{% endflag %}
									data-parent="#accordian">HOW</button></li>
      <li><button type="button" class="btn hubnav"
{% flag section_we %}
									data-toggle="collapse"
									data-target="#collapseTwo"
{% endflag %}
									data-parent="#accordian">WE</button></li>
      <li><button type="button" class="btn hubnav"
{% flag section_work %}
									data-toggle="collapse"
									data-target="#collapseThree"
{% endflag %}
									data-parent="#accordian">WORK</button></li>
      <li><button type="button" class="btn hubnav"
{% flag section_now %}
									data-toggle="collapse"
									data-target="#collapseFour"
{% endflag %}
									data-parent="#accordian">NOW</button></li>

		</ul>
{% endblock %}

{% block bodytag %}
{% if request.user.is_anonymous %}
<body class="" id="splash-page">
{% else %}
<body class="{% block bodyclass %}{% endblock %}" id="index-page{% block bodyid %}{% endblock %}">
{% endif %}
{% endblock %}

{% block content %}


<div class="panel-group" id="accordion">
  <div class="panel panel-default">
    <a {% flag section_how %} data-toggle="collapse"
			 data-parent="#accordion" href="#collapseOne"{% endflag %}>
    	<div id="hub1" class="panel-heading">
      	<div class="panel-title"> 
         How
        </div>
        <div class="desc">Cross-functional conversations between Art, Design, and Strategy</div>
        <span class="glyphicon glyphicon-play"></span>
        
	    </div>
     </a>
{% flag section_how %}
    <div id="collapseOne" class="panel-collapse collapse">
      <div class="panel-body">
		<div class="container">
       	<div class="panelbreak white"></div>
			 {% if conversation %}

			 <form action="/item/{{conversation.id}}/reply/" method="post"
						 enctype="multipart/form-data" role="form">
				 <div class="modal fade" id="add-text-reply">
					 <div class="modal-dialog">
						 <div class="modal-content">
							 <div class="modal-header">
								 <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
								 <h4 class="modal-title">Add Reply</h4>
							 </div>
							 <div class="modal-body">

								 <div class="form-group">
									 <label for="comment-body">Comment</label>
									 <textarea name="body" class="form-control" rows="10"
														 id="comment-body"></textarea>
								 </div>

							 </div>
							 <div class="modal-footer">
								 <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
								 <input type="submit" class="btn btn-primary" value="Reply"/>
							 </div>
						 </div><!-- /.modal-content -->
					 </div><!-- /.modal-dialog -->
				 </div><!-- /.modal -->
			 </form>

			 <form action="/item/{{conversation.id}}/reply/" method="post"
						 enctype="multipart/form-data" role="form">
				 <div class="modal fade" id="add-link-reply">
					 <div class="modal-dialog">
						 <div class="modal-content">
							 <div class="modal-header">
								 <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
								 <h4 class="modal-title">Add Link Reply</h4>
							 </div>
							 <div class="modal-body">

								 <div class="form-group">
									 <label for="link-url">URL</label>
									 <input type="text" name="url" class="form-control"
									 id="link-url" placeholder="http://" />
								 </div>

								 <div class="form-group">
									 <label for="link-title">Link Title</label>
									 <input type="text" name="title" class="form-control"
									 id="link-title" />
								 </div>

							 </div>
							 <div class="modal-footer">
								 <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
								 <input type="submit" class="btn btn-primary" value="Reply"/>
							 </div>
						 </div><!-- /.modal-content -->
					 </div><!-- /.modal-dialog -->
				 </div><!-- /.modal -->
			 </form>

			 <form action="/item/{{conversation.id}}/reply/" method="post"
						 enctype="multipart/form-data" role="form">
				 <div class="modal fade" id="add-image-reply">
					 <div class="modal-dialog">
						 <div class="modal-content">
							 <div class="modal-header">
								 <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
								 <h4 class="modal-title">Add Image Reply</h4>
							 </div>
							 <div class="modal-body">

								 <div class="form-group">
									 <label for="exampleInputFile">Image</label>
									 <input type="file" id="image" name="image">
								 </div>

								 <div class="form-group">
									 <label for="comment-body">Caption</label>
									 <textarea name="body" class="form-control" rows="10"
														 id="comment-body"></textarea>
								 </div>

							 </div>
							 <div class="modal-footer">
								 <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
								 <input type="submit" class="btn btn-primary" value="Reply"/>
							 </div>
						 </div><!-- /.modal-content -->
					 </div><!-- /.modal-dialog -->
				 </div><!-- /.modal -->
			 </form>


       <h2>{{conversation.title}}</h2>
			 {{conversation.body|markdown}}
			 <div class="panelbreak white"></div>
			 <div class="addvoice">
			 	<p>Add your voice to the conversation:
				 <ul class="list-inline">
					 <li><a href="#add-text-reply" data-toggle="modal" data-target="#add-text-reply"><img src="/media/img/text_convo.png"></a></li>
					 <li><a href="#add-link-reply" data-toggle="modal" data-target="#add-link-reply" ><img src="/media/img/link_convo.png"></a></li>
					 <li><a href="#add-image-reply" data-toggle="modal" data-target="#add-image-reply"><img src="/media/img/image_convo.png"></a></li>
				 </ul>
			 </p>
			 </div>
			 			 <div class="panelbreak white"></div>

			  <div class="hubconvo">

				{% for reply_one, reply_two in conversation.reply_pairs %}

				 <div class="row">
					 <div class="col-sm-1 col-md-1">
						 <a href="/accounts/{{reply_one.author.username}}/"><img class="mugshot" src="{{ reply_one.author.get_profile.get_mugshot_url }}" 
									class="user_icon" width="100" height="100"></a>
						 </div>
					<div class="col-sm-5 col-md-5">
						<div class="convoblock">
							<div class="convoheader">
								<div class="user_name"><a href="/accounts/{{reply_one.author.username}}/">{{reply_one.author.username}}</a>
								| {{reply_one.author.get_profile.discipline1}}{% if reply_one.author.get_profile.discipline2 %} /
								{{reply_one.author.get_profile.discipline2}}{% endif %}</div>
								<div class="user_time">{{reply_one.added|timesince}}
								ago  |  {{reply_one.author.get_profile.city}}, {{reply_one.author.get_profile.country}}</div>
								</div>
								       <div class="panelbreak black"></div>
								       
								<div class="convocontent">
										{% if reply_one.url %}
								<h3><span class="glyphicon glyphicon-link"></span><a href="{{reply_one.url}}">{% if reply_one.title %}
								{{reply_one.title}}{% else %}{{reply_one.url}}{% endif %}</h3>
								{% endif %}
								{{reply_one.body|markdown}}
											 {% if reply_one.image %}
											 <img src="{% thumbnail reply_one.image 400x400 %}" />
								{% endif %}
								</div>
						</div>
					</div>
{% if reply_two %}
					<div class="col-sm-5 col-md-5">
						<div class="convoblock">
							<div class="convoheader">
								<div class="user_name"><a href="/accounts/{{reply_two.author.username}}/">{{reply_two.author.username}}</a>
									| {{reply_two.author.get_profile.discipline1}}
									{% if reply_two.author.get_profile.discipline1 %}
									/ {{reply_two.author.get_profile.discipline2}}{% endif %}</div>
								<div class="user_time">{{reply_two.added|timesince}} ago  |  {{reply_two.author.get_profile.city}}, {{reply_two.author.get_profile.country}}</div>
								</div>
								 <div class="panelbreak black"></div>
									{% if reply_two.url %}
									<h3><span class="glyphicon glyphicon-link"></span><a href="{{reply_two.url}}">{% if reply_two.title %}
									{{reply_two.title}}{% else %}{{reply_two.url}}{% endif %}</h3>
									{% endif %}
											 {{reply_two.body|markdown}}
											 {% if reply_two.image %}
											 <img src="{% thumbnail reply_two.image 400x400 %}" />
								{% endif %}
								
						</div>
					</div>
					<div class="col-sm-1 col-md-1">
						 <a href="/accounts/{{reply_two.author.username}}/"><img class="mugshot" src="{{ reply_two.author.get_profile.get_mugshot_url }}" 
									class="user_icon" width="100" height="100"></a>
					</div>
{% endif %}
				 </div>
				 {% endfor %}

				</div>
			 {% else %}

			 <p>No conversations yet...</p>
			 {% endif %}

				</div>
      </div>
    </div>
{% endflag %}
  </div>
			 
		

  <div class="panel panel-default">
  <a {% flag section_we %}data-toggle="collapse"
		 data-parent="#accordion" href="#collapseTwo"{% endflag %}>
  	 <div id="hub2" class="panel-heading">
      <div class="panel-title">
          We        
      </div>
      <div class="desc">A MANIFESTO OF (TROUBLE) MAKERS</div>
      <span class="glyphicon glyphicon-play"></span>
    </div>
      </a>
{% flag section_we %}
    <div id="collapseTwo" class="panel-collapse collapse">
      <div class="panel-body">
				<div class="container video">
<iframe src="//player.vimeo.com/video/104999392?portrait=0&badge=0&byline=0&title=0" width="900"height="506" frameborder="0" webkitallowfullscreen
				mozallowfullscreen allowfullscreen></iframe>
				</div>
      </div>
    </div>
{% endflag %}
  </div>

  <div class="panel panel-default">
<a {% flag section_work %} data-toggle="collapse"
	 data-parent="#accordion" href="#collapseThree"{% endflag %}>  	
    <div id="hub3" class="panel-heading">
      <div class="panel-title">
          Work        
      </div>
      <div class="desc">Shiny ideas + blood, sweat and tears</div>
      <span class="glyphicon glyphicon-play"></span>
    </div>
</a>
{% flag section_work %}
    <div id="collapseThree" class="panel-collapse collapse">
      <div class="panel-body">

<div id="slider1_container" style="position: relative; top: 0px; left: 0px; width: 600px; height: 300px; overflow: hidden;">
    <!-- Slides Container -->
    <div u="slides" style="cursor: move; position: absolute; overflow: hidden; left: 0px; top: 0px; width: 600px; height: 300px;">
    	{% for ws in work_samples %}	
        <div><img u="image" src="{% thumbnail ws.image 1140x700 %}" alt="{{ws.title}}"/></div>
        <div u="caption" t="caption-transition-name" style="position: absolute; top: 125px; left: 125px; width: 350px;height: 50px;">
     		 {{ws.user.username}}: {{ws.title}}
			</div>
	{% endfor %}
    </div>
    <!-- Trigger -->
    <script>jssor_slider1_starter('slider1_container');</script>
	 <!-- Arrow Navigator Skin Begin -->
        <style>
            /* jssor slider arrow navigator skin 21 css */
            /*
            .jssora21l              (normal)
            .jssora21r              (normal)
            .jssora21l:hover        (normal mouseover)
            .jssora21r:hover        (normal mouseover)
            .jssora21ldn            (mousedown)
            .jssora21rdn            (mousedown)
            */
            .jssora21l, .jssora21r, .jssora21ldn, .jssora21rdn
            {
            	position: absolute;
            	cursor: pointer;
            	display: block;
                background: url(/media/img/a21.png) center center no-repeat;
                overflow: hidden;
            }
            .jssora21l { background-position: -3px -33px; }
            .jssora21r { background-position: -63px -33px; }
            .jssora21l:hover { background-position: -123px -33px; }
            .jssora21r:hover { background-position: -183px -33px; }
            .jssora21ldn { background-position: -243px -33px; }
            .jssora21rdn { background-position: -303px -33px; }
        </style>
        <!-- Arrow Left -->
        <span u="arrowleft" class="jssora21l" style="width: 55px; height: 55px; top: 123px; left: 8px;">
        </span>
        <!-- Arrow Right -->
        <span u="arrowright" class="jssora21r" style="width: 55px; height: 55px; top: 123px; right: 8px">
        </span>
        <!-- Arrow Navigator Skin End -->
	</div>

</div>
      
      
    </div>
          	{% endflag %}

  </div>

  <div class="panel panel-default active-panel">
<a {% flag section_now %}data-toggle="collapse"
	 data-parent="#accordion" href="#collapseFour"{% endflag %}>
  	    <div id="hub4" class="panel-heading">
      <div class="panel-title">
          Now
      </div>
      <div class="desc">Updates in Hub Mean Time (HMT)</div>
      <span class="glyphicon glyphicon-play"></span>
    </div>
      </a>
{% flag section_now %}
    <div id="collapseFour" class="panel-collapse collapse in">
      <div class="panel-body">
				<div id="nowtiles" data-masonry-options='{ "gutter": 30 }'>

					{% for post in now_posts %}
					<div class="nowtile">
						<div class="nowtileheader"><a href="/accounts/{{post.user.username}}/">{{post.user.username}}</a> |	{{post.user.get_profile.city}}, {{post.user.get_profile.country}}
						</div>
						{% if post.image_url %}
						<img src="{{post.image_url}}"
								 width="{{post.image_width}}"
								 height="{{post.image_height}}" /><br />
						{% endif %}
						<p>{{post.text|urlize}}</p>
						<div class="nowtilefooter">
						<a href="{{post.external_link}}">{{post.created|timesince}} ago</a>
						</div>
					</div>
					{% endfor %}
				
     			 </div>
    </div>
  </div>
{% endflag %}
</div>

{% endblock %}

{% block js %}
<script src="/media/js/flexslide/jquery.flexslider-min.js"></script>
<script src="/media/js/masonry.pkgd.js"></script>
<script src="/media/js/jssor.slider.mini.js"></script>
<link rel="stylesheet" href="/media/js/flexslide/flexslider.css" type="text/css">
<script>
	var $container = $('#nowtiles');
	// initialize
	$('#nowtiles').masonry({
  columnWidth: 40,
  itemSelector: '.nowtile'
});
</script>

<script>
jQuery(document).ready(function ($) {

     function ScaleSlider() {
            var parentWidth = $('#slider1_container').parent().width();
            if (parentWidth) {
                jssor_slider1.$SetScaleWidth(parentWidth);
            }
            else
                window.setTimeout(ScaleSlider, 30);
        }
        //Scale slider after document ready
        ScaleSlider();
        if (!navigator.userAgent.match(/(iPhone|iPod|iPad|BlackBerry|IEMobile)/)) {
            //Capture window resize event
            $(window).bind('resize', ScaleSlider);
        }
        //responsive code end
         var options = {
            $ArrowNavigatorOptions: {
                $Class: $JssorArrowNavigator$,
                $ChanceToShow: 2
            }
        };
        
        var options = {};                            
     var jssor_slider1 = new $JssorSlider$('slider1_container', options);
    });
    
   
</script>

<script>
$(".panel").on('hidden.bs.collapse', function (e) {
   $(e.target).parent().removeClass('active-panel');
});
$(".panel").on('shown.bs.collapse', function (e) {
   $(e.target).parent().addClass('active-panel');
});
</script>


{% endblock %}
